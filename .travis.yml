language: python

dist: xenial

stages:
  - compile
  - test
  # - deploy
  # if: branch = master

script:
  - find . | grep -E "\.py$" | xargs python -m compileall

jobs:
  include:
    # Compile all files.
    - stage: compile
      python: 3.6
    - stage: compile
      python: 3.7       # 3.6 stable/release
    - stage: compile
      python: 3.7-dev   # 3.7 development branch
    - stage: compile
      python: 3.8-dev   # 3.8 development branch

    # Run tests
    - stage: test
      python: 3.7
      name: "pep8 conformance"
      install:
        - pip install pycodestyle
      script:
        - pycodestyle src  --ignore=E501

cache: pip
